# 学习笔记：SAITS——基于自注意力的时间序列缺失值填充方法

## 论文信息

-   **标题**：SAITS: SELF-ATTENTION-BASED IMPUTATION FOR TIME SERIES
    
-   **作者**：Wenjie Du、David Cote、Yan Liu
    
-   **单位**：Concordia University（蒙特利尔）、Ciena Corporation（渥太华）
    
-   **出版日期**：2023年7月6日
    
-   **论文链接**：[https://arxiv.org/pdf/2202.08516](https://arxiv.org/pdf/2202.08516)
    

## 研究背景与问题

-   **时间序列数据的重要性**：在交通、经济、医疗和气象等领域广泛应用。
    
-   **缺失值问题**：由于传感器故障、通信错误等原因，实际环境中的时间序列数据常存在缺失值，影响数据的可解释性和高级分析任务（如分类和聚类）的性能。
    
-   **传统处理方法的局限性**：
    
    -   删除法会导致数据不完整且可能产生偏差。
        
    -   传统数据填充方法（如线性回归、均值/中位数平均和k近邻）对缺失数据的假设较强，可能引入偏差。
        

## 研究方法与贡献

-   **SAITS模型**：基于自注意力机制的多变量时间序列缺失值填充新方法。通过联合优化训练方法学习缺失值，利用两个对角掩码自注意力（DMSA）块的加权组合来明确捕捉时间依赖性和特征间相关性。
    
-   **联合优化训练方法**：结合掩码填充任务（MIT）和观测重建任务（ORT）来训练自注意力模型，提升模型在缺失值填充和观测值重建方面的性能。
    
-   **主要贡献**：
    
    1.  设计了适用于自注意力模型的联合优化训练方法，使Transformer在时间序列填充任务上超越现有最佳方法。
        
    2.  提出了SAITS模型，通过加权组合两个DMSA块，使其能够明确捕捉时间步骤间的时间依赖性和特征相关性。
        
    3.  在四个真实世界公共数据集上进行了充分的实验和消融研究，证明了SAITS在填充精度上的优越性，并展示了其在处理不完整时间序列数据时提升模式识别模型学习性能的潜力。
        

## 方法细节与关键结论

### 1. 时间序列缺失值的定义与分类

-   **缺失完全随机（MCAR）**：缺失值与其他值独立。
    
-   **缺失随机（MAR）**：缺失值仅依赖于观测值。
    
-   **缺失非随机（MNAR）**：缺失值依赖于观测值和未观测值。本文主要关注MCAR情况。
    

### 2. 联合优化训练方法

-   **掩码填充任务（MIT）**：通过随机掩码部分观测值来强制模型准确预测缺失值。
    
-   **观测重建任务（ORT）**：使模型尽可能精确地重建观测值。
    
-   **训练目标**：通过结合MIT和ORT的损失函数，使模型在填充缺失值和重建观测值方面都能得到良好训练。
    

### 3. SAITS模型架构

-   **对角掩码自注意力（DMSA）**：在自注意力机制中应用对角掩码，使输入值无法看到自身，从而只能依赖其他时间步骤的输入值进行估计，增强了模型捕捉时间依赖性和特征间相关性的能力。
    
-   **位置编码和前馈网络**：保留Transformer中的位置编码和全连接前馈网络，以利用序列顺序信息并增强模型的非线性表示能力。
    
-   **两个DMSA块和加权组合块**：
    
    -   第一个DMSA块：将实际输入特征向量和缺失掩码向量拼接作为输入，通过多层DMSA和前馈网络进行处理，生成初步填充结果。
        
    -   第二个DMSA块：在第一个DMSA块的输出基础上继续学习，采用更深的结构以捕捉更复杂的时间序列相关性。
        
    -   加权组合块：根据时间依赖性和缺失信息动态为两个DMSA块生成的表示分配权重，形成最终的填充结果。
        

### 4. 实验

-   **数据集**：在四个不同领域的真实世界公共数据集上进行实验，包括PhysioNet 2012、北京多站点空气质量、电力负荷图和电力变压器温度数据集。
    
-   **基线方法**：与两个简单填充方法（中位数填充和最后观测值填充）以及五个最新的深度学习模型（GRUI-GAN、E2GAN、M-RNN、GP-VAE和BRITS）进行比较。
    
-   **评估指标**：采用平均绝对误差（MAE）、均方根误差（RMSE）和平均相对误差（MRE）作为评估指标。
    
-   **主要结果**：SAITS在所有数据集和评估指标上均显著优于基线方法，且在模型参数数量和训练速度上优于其他自注意力基模型。与BRITS相比，SAITS在MAE上降低12%至38%，训练速度提升2.0至2.6倍；与NRTSI相比，SAITS的填充精度提升7%至39%。
    

### 5. 消融实验

-   **对角掩码的有效性**：通过对比SAITS-base和无对角掩码的SAITS-base-w/o，证明DMSA提升了模型的填充能力。
    
-   **加权组合的合理性**：比较加权组合与无组合及残差组合的设计，验证加权组合在结合两个DMSA块表示方面的优势。
    
-   **DMSA块数量的影响**：增加到三个DMSA块并未带来性能提升，反而增加了参数数量和计算资源浪费，证明两个DMSA块的设计更为合理。
    

## 研究意义与未来工作

-   **研究意义**：SAITS通过有效利用自注意力机制，在时间序列缺失值填充任务上取得了新的最佳精度，并且具有更高的训练效率，为处理不完整时间序列数据提供了一种有效的方法，有助于提升模式识别模型在实际应用中的性能。
    
-   **未来工作**：研究SAITS在具有其他缺失模式的部分观测时间序列上的填充性能，并在其他真实世界大型数据集上验证模型的通用性。
    

## 总结

SAITS作为一种新颖的基于自注意力的时间序列缺失值填充方法，通过联合优化训练策略和独特的模型架构设计，在多个真实数据集上实现了优越的填充性能。其创新的对角掩码自注意力机制和加权组合策略有效地捕捉了时间序列数据中的复杂依赖关系，为时间序列分析领域提供了一个强大的工具，有望在各种实际应用中发挥重要作用。
